
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Market &#8212; Terra Docs  documentation</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.59c74d8c95b765a7fd995ac71d459ebe.min.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="shortcut icon" href="../../../_static/docs_favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Mint" href="spec-mint.html" />
    <link rel="prev" title="Governance" href="spec-governance.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/docs_logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../learn/README.html">
   Learn
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../learn/terra-station/README.html">
     Terra Station
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../learn/terra-station/download/README.html">
       Download
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/download/terra-station-desktop.html">
         Terra Station desktop
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/download/terra-station-extension.html">
         Terra Station extension
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/download/terra-station-mobile.html">
         Terra Station mobile
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../learn/terra-station/station-guides/README.html">
       Terra Station guides
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/station-guides/wallet.html">
         Wallet
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/station-guides/staking.html">
         Manage delegations
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/station-guides/swap.html">
         Mint, burn, or swap
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/station-guides/governance.html">
         Governance
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/station-guides/contracts.html">
         Contracts
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../learn/terra-station/station-guides/testnet.html">
         Use the testnet
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../learn/protocol.html">
     About the Terra Protocol
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../learn/fees.html">
     Fees on Terra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../learn/glossary.html">
     Glossary
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../README.html">
   Develop
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../dapp/README.html">
     Build a dApp
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../dapp/quick-start/README.html">
       5-minute quickstart guide
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
      <label for="toctree-checkbox-7">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../dapp/quick-start/initial-setup.html">
         Initial setup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../dapp/quick-start/using-terrain.html">
         Using Terrain
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../dapp/smart-contracts/README.html">
       In-depth dApp guide
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../dapp/smart-contracts/build-terra-dapp.html">
         Build a simple Terra dApp
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../dapp/smart-contracts/interact-with-smart-contract.html">
         Interacting with the Contract
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../dapp/smart-contracts/manage-cw20-tokens.html">
         CW20 Tokens
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../dapp/smart-contracts/set-up-local-environment.html">
         Environment Setup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../dapp/smart-contracts/write-smart-contract.html">
         Writing the Contract
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../how-to/README.html">
     Guides
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../how-to/terrad/README.html">
       terrad
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/terrad/install-terrad.html">
         Install terrad
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/terrad/using-terrad.html">
         Using terrad
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/terrad/commands.html">
         Commands
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/terrad/subcommands.html">
         Subcommands
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../how-to/localterra/README.html">
       LocalTerra
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/localterra/install-localterra.html">
         Install LocalTerra
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/localterra/configure.html">
         Configure LocalTerra
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/localterra/integrations.html">
         Integrations
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../how-to/localterra/accounts.html">
         Accounts
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../how-to/sign-with-multisig.html">
       Sign with a multisig account
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../how-to/start-lcd.html">
       Start the light client daemon (LCD)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="README.html">
     Terra core modules
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="spec-auth.html">
       Auth
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-authz.html">
       AuthZ
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-bank.html">
       Bank
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-capability.html">
       Capability
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-distribution.html">
       Distribution
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-evidence.html">
       Evidence
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-feegrant.html">
       Fee grant
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-governance.html">
       Governance
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Market
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-mint.html">
       Mint
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-oracle.html">
       Oracle
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-slashing.html">
       Slashing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-staking.html">
       Staking
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-treasury.html">
       Treasury
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="spec-wasm.html">
       WASM
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../sdks/README.html">
     SDKs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../sdks/terra-js/README.html">
       Terra.js
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
      <label for="toctree-checkbox-14">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/add-modules.html">
         Add modules
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/coin-and-coins.html">
         Coin and Coins
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/common-examples.html">
         Common examples
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/fees.html">
         Fees
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/keys.html">
         Keys
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/make-a-connection.html">
         Make a connection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/msgAuthorization.html">
         MsgAuthorization
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/multisend.html">
         MsgSend
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/numeric.html">
         Numeric
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/oracle-feeder.html">
         Oracle feeder
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/query-data.html">
         Query data
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/smart-contracts.html">
         Smart contracts
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/station-extension.html">
         Terra Station extension
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/transactions.html">
         Transactions
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/wallets.html">
         Wallets
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../sdks/terra-js/Websockets.html">
         Websockets
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../reference/README.html">
     Dev reference
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../reference/endpoints.html">
       RPC endpoints
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../reference/history-and-changes.html">
       History and changes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../reference/migration-guide.html">
       Columbus-5 upgrade
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../full-node/README.html">
   Full node
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../full-node/run-a-full-terra-node/README.html">
     Run a full Terra node
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/run-a-full-terra-node/system-config.html">
       System configuration
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/run-a-full-terra-node/build-terra-core.html">
       Build Terra core
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/run-a-full-terra-node/set-up-production.html">
       Set up a production environment
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/run-a-full-terra-node/configure-general-settings.html">
       Configure general settings
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/run-a-full-terra-node/join-a-network.html">
       Join a network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/run-a-full-terra-node/sync.html">
       Sync
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/run-a-full-terra-node/updates-and-additional.html">
       Updates and additional settings
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../full-node/manage-a-terra-validator/README.html">
     Manage a validator
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/manage-a-terra-validator/court-delegations.html">
       Court delegations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/manage-a-terra-validator/faq.html">
       Validator FAQ
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/manage-a-terra-validator/implement-security.html">
       Implement security practices
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/manage-a-terra-validator/set-up-oracle-feeder.html">
       Set up an oracle feeder
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/manage-a-terra-validator/set-up-validator.html">
       Register your Terra validator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../full-node/manage-a-terra-validator/troubleshoot-validator-problems.html">
       Troubleshoot validator problems
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../full-node/reference/README.html">
     Node reference
    </a>
   </li>
  </ul>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../ecosystem/README.html">
   Ecosystem
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../ecosystem/explore.html">
     Explore the ecosystem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../ecosystem/integrations.html">
     Integrations
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/docs/develop/module-specifications/spec-market.md.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/terra-money/docs"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/terra-money/docs/issues/new?title=Issue%20on%20page%20%2Fdocs/develop/module-specifications/spec-market.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/terra-money/docs/edit/master/docs/docs/develop/module-specifications/spec-market.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concepts">
   Concepts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#swap-fees">
     Swap Fees
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#market-making-algorithm">
     Market Making Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#virtual-liquidity-pools">
     Virtual Liquidity Pools
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#swap-procedure">
     Swap Procedure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seigniorage">
     Seigniorage
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#state">
   State
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terra-pool-delta">
     Terra Pool Delta δ
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#message-types">
   Message Types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#msgswap">
     MsgSwap
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#msgswapsend">
     MsgSwapSend
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#k-computeswap">
     <code class="docutils literal notranslate">
      <span class="pre">
       k.ComputeSwap()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#k-applyswaptopool">
     <code class="docutils literal notranslate">
      <span class="pre">
       k.ApplySwapToPool()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transitions">
   Transitions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#end-block">
     End-Block
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parameters">
   Parameters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poolrecoveryperiod">
     PoolRecoveryPeriod
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basepool">
     BasePool
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minspread">
     MinSpread
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tobintax">
     TobinTax
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Market</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concepts">
   Concepts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#swap-fees">
     Swap Fees
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#market-making-algorithm">
     Market Making Algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#virtual-liquidity-pools">
     Virtual Liquidity Pools
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#swap-procedure">
     Swap Procedure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seigniorage">
     Seigniorage
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#state">
   State
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terra-pool-delta">
     Terra Pool Delta δ
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#message-types">
   Message Types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#msgswap">
     MsgSwap
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#msgswapsend">
     MsgSwapSend
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   Functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#k-computeswap">
     <code class="docutils literal notranslate">
      <span class="pre">
       k.ComputeSwap()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#k-applyswaptopool">
     <code class="docutils literal notranslate">
      <span class="pre">
       k.ApplySwapToPool()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transitions">
   Transitions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#end-block">
     End-Block
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parameters">
   Parameters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poolrecoveryperiod">
     PoolRecoveryPeriod
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basepool">
     BasePool
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minspread">
     MinSpread
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tobintax">
     TobinTax
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="market">
<h1>Market<a class="headerlink" href="#market" title="Permalink to this headline">¶</a></h1>
<p>The Market module enables atomic swaps between different Terra stablecoin denominations, and between Terra and Luna. This module ensures an available, liquid market, stable prices, and fair exchange rates between the protocol’s assets.</p>
<p>The price stability of TerraSDR is achieved through Terra&lt;&gt;Luna arbitrage activity against the protocol’s algorithmic market-maker, which expands and contracts Terra’s supply to maintain its peg.</p>
<div class="section" id="concepts">
<h2>Concepts<a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="swap-fees">
<h3>Swap Fees<a class="headerlink" href="#swap-fees" title="Permalink to this headline">¶</a></h3>
<p>Because Terra’s price feed is derived from validator oracles, a delay exists between the price reported on-chain and the real-time price.</p>
<p>The delay lasts around one minute (our oracle <code class="docutils literal notranslate"><span class="pre">VotePeriod</span></code> is 30 seconds), which is negligible for nearly all practical transactions. However, front-running attackers could take advantage of this delay and extract value from the network.</p>
<p>To defend against this type of attack, the Market module enforces the following swap fees:</p>
<ul>
<li><p><a class="reference internal" href="#tobintax"><span class="std std-doc"><strong>Tobin tax</strong></span></a> for spot-converting Terra&lt;&gt;Terra swaps</p>
<p>For example, assume that the current Tobin tax for KRT is 0.35%, the oracle reports that the Luna&lt;&gt;SDT exchange rate is 10 and the Luna&lt;&gt;KRT exchange rate is 10,000. Swapping 1 SDT would return 0.1 Luna, which is 1,000 KRT. After the Tobin tax is applied, you will have 996.5 KRT (0.35% of 1,000 is 3.5), a better rate than any retail currency exchange and remittance<a class="footnote-reference brackets" href="#id3" id="id1">1</a>.</p>
</li>
</ul>
<ul>
<li><p><a class="reference internal" href="#minspread"><span class="std std-doc"><strong>Minimum spread</strong></span></a> for Terra&lt;&gt;Luna swaps</p>
<p>The minimum spread is 0.5%. Using the same exchange rates we used above, swapping 1 SDT will return 995 KRT worth of Luna (0.5% of 1000 is 5, which is taken as the swap fee). If you reverse the direction of the swap, 1 Luna would return 9.95 SDT (0.5% of 10 is 0.05), or 9,950 KRT (0.5% of 10,000 = 50).</p>
</li>
</ul>
</div>
<div class="section" id="market-making-algorithm">
<h3>Market Making Algorithm<a class="headerlink" href="#market-making-algorithm" title="Permalink to this headline">¶</a></h3>
<p>Terra uses a Constant Product market-making algorithm to ensure liquidity for Terra&lt;&gt;Luna swaps. <a class="footnote-reference brackets" href="#id4" id="id2">2</a></p>
<p>With Constant Product, we define a value <span class="math notranslate nohighlight">\(CP\)</span> set to the size of the Terra pool multiplied by a set <strong>fiat value of Luna</strong>, and ensure our market-maker maintains it as invariant during any swaps by adjusting the spread.</p>
<div class="highlight-warning notranslate"><div class="highlight"><pre><span></span>Our implementation of Constant Product diverges from Uniswap&#39;s, as we use the fiat value of Luna instead of the size of the Luna pool. This nuance means changes in Luna&#39;s price don&#39;t affect the product, but rather the size of the Luna pool.
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[CP = Pool_{Terra} * Pool_{Luna} * (Price_{Luna}/Price_{SDR})\]</div>
<p>For example, we’ll start with equal pools of Terra and Luna, both worth 1000 SDR total. The size of the Terra pool is 1000 SDT, and assuming the price of Luna&lt;&gt;SDR is 0.5, the size of the Luna pool is 2000 Luna. A swap of 100 SDT for Luna would return around 90.91 SDR worth of Luna (≈ 181.82 Luna). The offer of 100 SDT is added to the Terra pool, and the 90.91 SDT worth of Luna are taken out of the Luna pool.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CP</span> <span class="o">=</span> <span class="mi">1000000</span> <span class="n">SDR</span>
<span class="p">(</span><span class="mi">1000</span> <span class="n">SDT</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1000</span> <span class="n">SDR</span> <span class="n">of</span> <span class="n">Luna</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1000000</span> <span class="n">SDR</span>
<span class="p">(</span><span class="mi">1100</span> <span class="n">SDT</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">909.0909</span><span class="o">...</span> <span class="n">SDR</span> <span class="n">of</span> <span class="n">Luna</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1000000</span> <span class="n">SDR</span>
</pre></div>
</div>
<p>This is meant to be an example. In reality, liquidity pools are much larger, diminishing the magnitude of the spread.</p>
<p>The primary advantage of Constant-Product is that it offers “unbounded” liquidity, and swaps of any size can be serviced.</p>
</div>
<div class="section" id="virtual-liquidity-pools">
<h3>Virtual Liquidity Pools<a class="headerlink" href="#virtual-liquidity-pools" title="Permalink to this headline">¶</a></h3>
<p>The market starts out with two liquidity pools of equal sizes, one representing all denominations of Terra and another representing Luna. The parameter <a class="reference internal" href="#basepool"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">BasePool</span></code></span></a> defines the initial size, <span class="math notranslate nohighlight">\(Pool_{Base}\)</span>, of the Terra and Luna liquidity pools.</p>
<p>Rather than keeping track of the sizes of the two pools, this information is encoded in a number <span class="math notranslate nohighlight">\(\delta\)</span>, which the blockchain stores as <code class="docutils literal notranslate"><span class="pre">TerraPoolDelta</span></code>. This represents the deviation of the Terra pool from its base size in units µSDR.</p>
<p>The size of the Terra and Luna liquidity pools can be generated from <span class="math notranslate nohighlight">\(\delta\)</span> using the following formulas:</p>
<div class="math notranslate nohighlight">
\[Pool_{Terra} = Pool_{Base} + \delta\]</div>
<div class="math notranslate nohighlight">
\[Pool_{Luna} = ({Pool_{Base}})^2 / Pool_{Terra}\]</div>
<p>At the <a class="reference internal" href="#end-block"><span class="std std-doc">end of each block</span></a>, the market module attempts to replenish the pools by decreasing the magnitude of <span class="math notranslate nohighlight">\(\delta\)</span> between the Terra and Luna pools. The rate at which the pools will be replenished toward equilibrium is set by the parameter <a class="reference internal" href="#poolrecoveryperiod"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">PoolRecoveryPeriod</span></code></span></a>. Lower periods mean lower sensitivity to trades: previous trades are more quickly forgotten and the market is able to offer more liquidity.</p>
<p>This mechanism ensures liquidity and acts as a low-pass filter, allowing for the spread fee (which is a function of <code class="docutils literal notranslate"><span class="pre">TerraPoolDelta</span></code>) to drop back down when there is a change in demand, causing a necessary change in supply which needs to be absorbed.</p>
</div>
<div class="section" id="swap-procedure">
<h3>Swap Procedure<a class="headerlink" href="#swap-procedure" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>The Market module receives <a class="reference internal" href="#msgswap"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">MsgSwap</span></code></span></a> message and performs basic validation checks.</p></li>
<li><p>Calculate exchange rate <span class="math notranslate nohighlight">\(ask\)</span> and <span class="math notranslate nohighlight">\(spread\)</span> using <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">k.ComputeSwap()</span></code></span>.</p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">TerraPoolDelta</span></code> with <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">k.ApplySwapToPool()</span></code></span>.</p></li>
<li><p>Transfer <code class="docutils literal notranslate"><span class="pre">OfferCoin</span></code> from account to module using <code class="docutils literal notranslate"><span class="pre">supply.SendCoinsFromAccountToModule()</span></code>.</p></li>
<li><p>Burn offered coins, with <code class="docutils literal notranslate"><span class="pre">supply.BurnCoins()</span></code>.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(fee = spread * ask\)</span>, this is the spread fee.</p></li>
<li><p>Mint <span class="math notranslate nohighlight">\(ask - fee\)</span> coins of <code class="docutils literal notranslate"><span class="pre">AskDenom</span></code> with <code class="docutils literal notranslate"><span class="pre">supply.MintCoins()</span></code>. This implicitly applies the spread fee as the <span class="math notranslate nohighlight">\(fee\)</span> coins are burned.</p></li>
<li><p>Send newly minted coins to trader with <code class="docutils literal notranslate"><span class="pre">supply.SendCoinsFromModuleToAccount()</span></code>.</p></li>
<li><p>Emit <code class="docutils literal notranslate"><span class="pre">swap</span></code> event to publicize the swap and record the spread fee.</p></li>
</ol>
<p>If the trader’s <code class="docutils literal notranslate"><span class="pre">Account</span></code> has insufficient balance to execute the swap, the swap transaction fails.</p>
<p>Upon successful completion of Terra&lt;&gt;Luna swaps, a portion of the coins to be credited to the user’s account is withheld as the spread fee.</p>
</div>
<div class="section" id="seigniorage">
<h3>Seigniorage<a class="headerlink" href="#seigniorage" title="Permalink to this headline">¶</a></h3>
<p>When Luna swaps into Terra, the Luna recaptured by the protocol is called seigniorage – the value generated from issuing new Terra. The total seigniorage at the end of each epoch is calculated and reintroduced into the economy as ballot rewards for the exchange rate oracle and to the community pool by the Treasury module, described more fully <span class="xref myst">here</span>.</p>
<div class="highlight-warning notranslate"><div class="highlight"><pre><span></span>As of Columbus-5, all seigniorage is burned, and the community pool is no longer funded. Swap fees are used as ballot rewards for the exchange rate oracle.
</pre></div>
</div>
</div>
</div>
<div class="section" id="state">
<h2>State<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h2>
<div class="section" id="terra-pool-delta">
<h3>Terra Pool Delta δ<a class="headerlink" href="#terra-pool-delta" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>type: <code class="docutils literal notranslate"><span class="pre">sdk.Dec</span></code></p></li>
</ul>
<p>This represents the difference between the current Terra pool size and its original base size, valued in µSDR.</p>
</div>
</div>
<div class="section" id="message-types">
<h2>Message Types<a class="headerlink" href="#message-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="msgswap">
<h3>MsgSwap<a class="headerlink" href="#msgswap" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">MsgSwap</span></code> transaction denotes the <code class="docutils literal notranslate"><span class="pre">Trader</span></code>’s intent to swap their balance of <code class="docutils literal notranslate"><span class="pre">OfferCoin</span></code> for a new denomination <code class="docutils literal notranslate"><span class="pre">AskDenom</span></code>. Terra&lt;&gt;Terra swaps incur gas and the Tobin tax, and Terra&lt;&gt;Luna swaps incur gas and a spread fee.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// MsgSwap contains a swap request</span>
<span class="kd">type</span> <span class="nx">MsgSwap</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">Trader</span>    <span class="nx">sdk</span><span class="p">.</span><span class="nx">AccAddress</span> <span class="s">`json:&quot;trader&quot; yaml:&quot;trader&quot;`</span>         <span class="c1">// Address of the trader</span>
	<span class="nx">OfferCoin</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Coin</span>       <span class="s">`json:&quot;offer_coin&quot; yaml:&quot;offer_coin&quot;`</span> <span class="c1">// Coin being offered</span>
	<span class="nx">AskDenom</span>  <span class="kt">string</span>         <span class="s">`json:&quot;ask_denom&quot; yaml:&quot;ask_denom&quot;`</span>   <span class="c1">// Denom of the coin to swap to</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="msgswapsend">
<h3>MsgSwapSend<a class="headerlink" href="#msgswapsend" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">MsgSwapSend</span></code> first swaps <code class="docutils literal notranslate"><span class="pre">OfferCoin</span></code> for <code class="docutils literal notranslate"><span class="pre">AskDenom</span></code> and then sends the acquired coins to <code class="docutils literal notranslate"><span class="pre">ToAddress</span></code>. Swap fees are charged to the sender.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">MsgSwapSend</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">FromAddress</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">AccAddress</span> <span class="s">`json:&quot;from_address&quot; yaml:&quot;from_address&quot;`</span> <span class="c1">// Address of the offer coin payer</span>
	<span class="nx">ToAddress</span>   <span class="nx">sdk</span><span class="p">.</span><span class="nx">AccAddress</span> <span class="s">`json:&quot;to_address&quot; yaml:&quot;to_address&quot;`</span>     <span class="c1">// Address of the recipient</span>
	<span class="nx">OfferCoin</span>   <span class="nx">sdk</span><span class="p">.</span><span class="nx">Coin</span>       <span class="s">`json:&quot;offer_coin&quot; yaml:&quot;offer_coin&quot;`</span>     <span class="c1">// Coin being offered</span>
	<span class="nx">AskDenom</span>    <span class="kt">string</span>         <span class="s">`json:&quot;ask_denom&quot; yaml:&quot;ask_denom&quot;`</span>       <span class="c1">// Denom of the coin to swap to</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="k-computeswap">
<h3><code class="docutils literal notranslate"><span class="pre">k.ComputeSwap()</span></code><a class="headerlink" href="#k-computeswap" title="Permalink to this headline">¶</a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="p">(</span><span class="nx">k</span> <span class="nx">Keeper</span><span class="p">)</span> <span class="nx">ComputeSwap</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">offerCoin</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Coin</span><span class="p">,</span> <span class="nx">askDenom</span> <span class="kt">string</span><span class="p">)</span>
    <span class="p">(</span><span class="nx">retDecCoin</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">DecCoin</span><span class="p">,</span> <span class="nx">spread</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Dec</span><span class="p">,</span> <span class="nx">err</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Error</span><span class="p">)</span>
</pre></div>
</div>
<p>This function detects the swap type from the offer and ask denominations and returns:</p>
<ol class="arabic simple">
<li><p>The amount of asked coins that should be returned for a given <code class="docutils literal notranslate"><span class="pre">offerCoin</span></code>. This is achieved by first spot-converting <code class="docutils literal notranslate"><span class="pre">offerCoin</span></code> to µSDR and then from µSDR to the desired <code class="docutils literal notranslate"><span class="pre">askDenom</span></code> with the proper exchange rate reported by the Oracle.</p></li>
<li><p>The spread percentage that should be taken as a swap fee given the swap type. Terra&lt;&gt;Terra swaps only have the Tobin Tax spread fee. Terra&lt;&gt;Luna swaps use the <code class="docutils literal notranslate"><span class="pre">MinSpread</span></code> or the Constant Product pricing spread, whichever is greater.</p></li>
</ol>
<p>If the <code class="docutils literal notranslate"><span class="pre">offerCoin</span></code>’s denomination is the same as <code class="docutils literal notranslate"><span class="pre">askDenom</span></code>, this will raise <code class="docutils literal notranslate"><span class="pre">ErrRecursiveSwap</span></code>.</p>
<div class="highlight-warning notranslate"><div class="highlight"><pre><span></span>`k.ComputeSwap()` uses `k.ComputeInternalSwap()` internally, which only contains the logic for calculating proper ask coins to exchange, and not the Constant Product spread.
</pre></div>
</div>
</div>
<div class="section" id="k-applyswaptopool">
<h3><code class="docutils literal notranslate"><span class="pre">k.ApplySwapToPool()</span></code><a class="headerlink" href="#k-applyswaptopool" title="Permalink to this headline">¶</a></h3>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="p">(</span><span class="nx">k</span> <span class="nx">Keeper</span><span class="p">)</span> <span class="nx">ApplySwapToPool</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Context</span><span class="p">,</span> <span class="nx">offerCoin</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Coin</span><span class="p">,</span> <span class="nx">askCoin</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">DecCoin</span><span class="p">)</span> <span class="nx">sdk</span><span class="p">.</span><span class="nx">Error</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">k.ApplySwapToPools()</span></code> is called during the swap to update the blockchain’s measure of <span class="math notranslate nohighlight">\(\delta\)</span>, <code class="docutils literal notranslate"><span class="pre">TerraPoolDelta</span></code>, when the balances of the Terra and Luna liquidity pools have changed.</p>
<p>All Terra stablecoins share the same liquidity pool, so <code class="docutils literal notranslate"><span class="pre">TerraPoolDelta</span></code> remains unaltered during Terra&lt;&gt;Terra swaps.</p>
<p>For Terra&lt;&gt;Luna swaps, the relative sizes of the pools will be different after the swap, and <span class="math notranslate nohighlight">\(\delta\)</span> will be updated with the following formulas:</p>
<ul class="simple">
<li><p>for Terra to Luna, <span class="math notranslate nohighlight">\(\delta' = \delta + Offer_{\mu SDR}\)</span></p></li>
<li><p>for Luna to Terra, <span class="math notranslate nohighlight">\(\delta' = \delta - Ask_{\mu SDR}\)</span></p></li>
</ul>
</div>
</div>
<div class="section" id="transitions">
<h2>Transitions<a class="headerlink" href="#transitions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="end-block">
<h3>End-Block<a class="headerlink" href="#end-block" title="Permalink to this headline">¶</a></h3>
<p>The Market module calls <code class="docutils literal notranslate"><span class="pre">k.ReplenishPools()</span></code> at the end of every block, which decreases the value of <code class="docutils literal notranslate"><span class="pre">TerraPoolDelta</span></code> (the difference between Terra and Luna pools) depending on <code class="docutils literal notranslate"><span class="pre">PoolRecoveryPeriod</span></code>, <span class="math notranslate nohighlight">\(pr\)</span>.</p>
<p>This allows the network to sharply increase spread fees during acute price fluctuations. After some time, the spread automatically returns to normal for long term price changes.</p>
</div>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>The subspace for the Market module is <code class="docutils literal notranslate"><span class="pre">market</span></code>.</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Params</span> <span class="kd">struct</span> <span class="p">{</span>
	<span class="nx">PoolRecoveryPeriod</span> <span class="kt">int64</span>   <span class="s">`json:&quot;pool_recovery_period&quot; yaml:&quot;pool_recovery_period&quot;`</span>
	<span class="nx">BasePool</span>           <span class="nx">sdk</span><span class="p">.</span><span class="nx">Dec</span> <span class="s">`json:&quot;base_pool&quot; yaml:&quot;base_pool&quot;`</span>
	<span class="nx">MinSpread</span>          <span class="nx">sdk</span><span class="p">.</span><span class="nx">Dec</span> <span class="s">`json:&quot;min_spread&quot; yaml:&quot;min_spread&quot;`</span>
	<span class="nx">TobinTax</span>           <span class="nx">sdk</span><span class="p">.</span><span class="nx">Dec</span> <span class="s">`json:&quot;tobin_tax&quot; yaml:&quot;tobin_tax&quot;`</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="poolrecoveryperiod">
<h3>PoolRecoveryPeriod<a class="headerlink" href="#poolrecoveryperiod" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>type: <code class="docutils literal notranslate"><span class="pre">int64</span></code></p></li>
<li><p>default: <code class="docutils literal notranslate"><span class="pre">BlocksPerDay</span></code></p></li>
</ul>
<p>The number of blocks it takes for the Terra &amp; Luna pools to naturally “reset” toward equilibrium (<span class="math notranslate nohighlight">\(\delta \to 0\)</span>) through automated pool replenishing.</p>
</div>
<div class="section" id="basepool">
<h3>BasePool<a class="headerlink" href="#basepool" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>type: <code class="docutils literal notranslate"><span class="pre">Dec</span></code></p></li>
<li><p>default: 250,000 SDR (= 250,000,000,000 µSDR)</p></li>
</ul>
<p>The initial starting size of both Terra and Luna liquidity pools.</p>
</div>
<div class="section" id="minspread">
<h3>MinSpread<a class="headerlink" href="#minspread" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>type: <code class="docutils literal notranslate"><span class="pre">Dec</span></code></p></li>
<li><p>default: 0.5%</p></li>
</ul>
<p>The minimum spread charged on Terra&lt;&gt;Luna swaps to prevent leaking value from front-running attacks.</p>
</div>
<div class="section" id="tobintax">
<h3>TobinTax<a class="headerlink" href="#tobintax" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>type: <code class="docutils literal notranslate"><span class="pre">Dec</span></code></p></li>
<li><p>default: 0.35%</p></li>
</ul>
<p>An additional fee for swapping between Terra currencies (spot-trading). The rate varies, depending on the denomination. For example, while the rate for most denominations is .35%, the rate for MNT is 2%. To see the rates, <span class="xref myst">query the oracle</span>.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Initially we maintained a policy for zero-fee swaps. However, to prevent front-running attackers from exploiting the exchange-rate latency and profiting at the expense of users, we implemented the Tobin tax. For more information, see <a class="reference external" href="https://medium.com/terra-money/on-swap-fees-the-greedy-and-the-wise-b967f0c8914e">“On swap fees: the greedy and the wise”</a>.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>For a more in-depth treatment of our updated market-making algorithm, check <a class="reference external" href="https://agora.terra.money/t/terra-stability-swap-mechanism-deep-dive-at-sfbw/135">Nick Platias’s SFBW 2019 presentation</a>.</p>
</dd>
</dl>
</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="spec-governance.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Governance</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="spec-mint.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Mint</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Terraform Labs<br/>
    
        &copy; Copyright 2021, Terraform Labs.<br/>
      <div class="extra_footer">
        <div class="logos"><a href="https://discord.gg/e29HWwC2Mz" rel="noopener" target="_blank"><img src="https://docs.terra.money/img/discord.svg" alt="link to Terra discord room"></a> <a href="https://medium.com/terra-money" rel="noopener" target="_blank"><img src="https://docs.terra.money/img/medium.svg" alt="link to Terra medium"></a> <a href="https://twitter.com/terra_money" rel="noopener" target="_blank"><img src="https://docs.terra.money/img/twitter.svg" alt="link to Terra twitter"></a> <a href="https://www.youtube.com/channel/UCoV1RXZ9ZBGcuu_PMTTlM0g" rel="noopener" target="_blank"><img src="https://docs.terra.money/img/icon_youtube.png" alt="link to Terra youtube"></a> <a href="https://t.me/terra_announcements" rel="noopener" target="_blank"><img src="https://docs.terra.money/img/icon_telegram.png" alt="link to Terra telegram room"></a></div>
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>